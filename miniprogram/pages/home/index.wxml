<view class="page">
  <view class="sticky">
    <view class="panel">
      <view class="panelTitle">分类</view>
      <scroll-view class="catScroll" scroll-x="true" show-scrollbar="false">
        <view class="catRow">
          <block wx:for="{{categories}}" wx:key="{{item}}">
            <view class="chip {{currentCategory===item ? 'chipActive' : ''}}" bindtap="onSelectCategory" data-value="{{item}}">
              {{item}}
            </view>
          </block>
        </view>
      </scroll-view>

      <view wx:if="{{!typeLocked}}" class="seg">
        <view class="segItem {{currentType==='all' ? 'segActive' : ''}}" bindtap="onSelectType" data-value="all">全部</view>
        <view class="segItem {{currentType==='work' ? 'segActive' : ''}}" bindtap="onSelectType" data-value="work">作品</view>
        <view class="segItem {{currentType==='package' ? 'segActive' : ''}}" bindtap="onSelectType" data-value="package">套餐</view>
      </view>
    </view>
  </view>

  <view class="content">
    <view wx:if="{{!loading && leftItems.length===0 && rightItems.length===0}}" class="empty">
      <view class="emptyArt">
        <view class="emptyBlob"></view>
        <view class="emptyLine"></view>
        <view class="emptyLine small"></view>
      </view>
      <view class="emptyTitle">暂无内容</view>
      <view class="emptyDesc">下拉刷新，或稍后再来看看</view>
      <view class="emptyBtn" bindtap="load">刷新</view>
    </view>

    <view wx:if="{{loading && leftItems.length===0 && rightItems.length===0}}" class="waterfall">
      <view class="col">
        <block wx:for="{{skLeft}}" wx:key="{{item.id}}">
          <view class="skCard" style="height: {{item._h}}rpx;"></view>
        </block>
      </view>
      <view class="col">
        <block wx:for="{{skRight}}" wx:key="{{item.id}}">
          <view class="skCard" style="height: {{item._h}}rpx;"></view>
        </block>
      </view>
    </view>

    <view wx:if="{{leftItems.length>0 || rightItems.length>0}}" class="waterfall">
      <view class="col">
        <block wx:for="{{leftItems}}" wx:key="{{item.id}}">
          <view class="itemCard" bindtap="openDetail" data-id="{{item.id}}" data-type="{{item.type}}">
            <view class="media" style="height: {{item._h}}rpx;">
              <image class="mediaImg" mode="aspectFill" src="{{item.coverUrl}}" />
              <view class="mediaShade" />
              <view class="badge">{{item.type==='package' ? '套餐' : '作品'}}</view>
              <view class="like" catchtap="toggleLike" data-id="{{item.id}}" data-type="{{item.type}}">
                <text class="likeIcon {{item.isLiked ? 'liked' : ''}}">♥</text>
                <text class="likeCount">{{item.likeCount}}</text>
              </view>
            </view>
            <view class="meta">
              <view class="title">{{item.title}}</view>
              <view class="sub">
                <view class="tag">{{item.category}}</view>
                <view wx:if="{{item.type==='package'}}" class="price">¥{{item.basePrice}}</view>
              </view>
            </view>
          </view>
        </block>
      </view>
      <view class="col">
        <block wx:for="{{rightItems}}" wx:key="{{item.id}}">
          <view class="itemCard" bindtap="openDetail" data-id="{{item.id}}" data-type="{{item.type}}">
            <view class="media" style="height: {{item._h}}rpx;">
              <image class="mediaImg" mode="aspectFill" src="{{item.coverUrl}}" />
              <view class="mediaShade" />
              <view class="badge">{{item.type==='package' ? '套餐' : '作品'}}</view>
              <view class="like" catchtap="toggleLike" data-id="{{item.id}}" data-type="{{item.type}}">
                <text class="likeIcon {{item.isLiked ? 'liked' : ''}}">♥</text>
                <text class="likeCount">{{item.likeCount}}</text>
              </view>
            </view>
            <view class="meta">
              <view class="title">{{item.title}}</view>
              <view class="sub">
                <view class="tag">{{item.category}}</view>
                <view wx:if="{{item.type==='package'}}" class="price">¥{{item.basePrice}}</view>
              </view>
            </view>
          </view>
        </block>
      </view>
    </view>
  </view>

  <view class="bottomSpacer" />
</view>
